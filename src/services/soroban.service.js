const readline = require("readline");

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

const NO_FORMULA = {
    0: {
        "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        "-": [0],
    },
    1: {
        "+": [0, 1, 2, 3, 5, 6, 7, 8],
        "-": [0, 1],
    },
    2: {
        "+": [0, 1, 2, 5, 6, 7],
        "-": [0, 1, 2],
    },
    3: {
        "+": [0, 1, 5, 6],
        "-": [0, 1, 2, 3],
    },
    4: {
        "+": [0, 5],
        "-": [0, 1, 2, 3, 4],
    },
    5: {
        "+": [0, 1, 2, 3, 4],
        "-": [0, 5],
    },
    6: {
        "+": [0, 1, 2, 3],
        "-": [0, 1, 5, 6],
    },
    7: {
        "+": [0, 1, 2],
        "-": [0, 1, 2, 5, 6, 7],
    },
    8: {
        "+": [0, 1],
        "-": [0, 1, 2, 3, 5, 6, 7, 8],
    },
    9: {
        "+": [0],
        "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
    },
};
const NO_FORMULA_SMALL = {
    0: {
        "+": [0, 1, 2, 3, 4],
        "-": [0],
    },
    1: {
        "+": [0, 1, 2, 3],
        "-": [0, 1],
    },
    2: {
        "+": [0, 1, 2],
        "-": [0, 1, 2],
    },
    3: {
        "+": [0, 1],
        "-": [0, 1, 2, 3],
    },
    4: {
        "+": [0],
        "-": [0, 1, 2, 3, 4],
    },
};

const randomMath = {
    0: {
        "+": [0, 1, 2, 3, 4, 5, 6, 8, 9],
        "-": [0, 1, 2, 3, 4, 5, 6, 8, 9],
    },
    1: {
        "+": [0, 1, 2, 3, 5, 6, 7, 8],
        "-": [1, 2, 3, 4, 6, 7, 8, 9],
    },
    2: {
        "+": [0, 1, 2, 5, 6, 7],
        "-": [2, 3, 4, 7, 8, 9],
    },
    3: {
        "+": [0, 1, 5, 6],
        "-": [3, 4, 8, 9],
    },
    4: {
        "+": [0, 5],
        "-": [4, 9],
    },
    5: {
        "+": [0, 1, 2, 3, 4],
        "-": [5, 6, 7, 8, 9],
    },
    6: {
        "+": [0, 1, 2, 3],
        "-": [6, 7, 8, 9],
    },
    7: {
        "+": [0, 1, 2],
        "-": [7, 8, 9],
    },
    8: {
        "+": [0, 1],
        "-": [8, 9],
    },
    9: {
        "+": [0],
        "-": [9],
    },
    10: {
        "+": [1, 2, 3, 4], // ABN +4
    },
    11: {
        "+": [2, 3, 4], // ABN +3
    },
    12: {
        "+": [3, 4], // ABN +2
    },
    13: {
        "+": [4], // ABN +1
    },
    14: {
        "-": [5, 6, 7, 8], // ABNT -4
    },
    15: {
        "-": [5, 6, 7], // ABNT -3
    },
    16: {
        "-": [5, 6], // ABNT -2
    },
    17: {
        "-": [5], // ABNT -1
    },
    18: {
        "+": [1, 2, 3, 4, 6, 7, 8, 9], // ABL +9
    },
    19: {
        "+": [2, 3, 4, 7, 8, 9], // ABL +8
    },
    20: {
        "+": [3, 4, 8, 9], // ABL +7
    },
    21: {
        "+": [4, 9], // ABL +6
    },
    22: {
        "+": [5, 6, 7, 8, 9], // ABL +5
    },
    23: {
        "+": [6, 7, 8, 9], // ABL +4
    },
    24: {
        "+": [7, 8, 9], // ABL +3
    },
    25: {
        "+": [8, 9], // ABL +2
    },
    26: {
        "+": [9], // ABL +1
    },
    27: {
        "+": [5], // ABT +9
    },
    28: {
        "+": [5, 6], // ABT +8
    },
    29: {
        "+": [5, 6, 7], // ABT +7
    },
    30: {
        "+": [5, 6, 7, 8], // ABT +6
    },
    31: {
        "-": [0, 1, 2, 3, 5, 6, 7, 8], // ABL -9
    },
    32: {
        "-": [0, 1, 2, 5, 6, 7], // ABL -8
    },
    33: {
        "-": [0, 1, 5, 6], // ABL -7
    },
    34: {
        "-": [0, 5], // ABL -6
    },
    35: {
        "-": [0, 1, 2, 3, 4], // ABL -5
    },
    36: {
        "-": [0, 1, 2, 3], // ABL -4
    },
    37: {
        "-": [0, 1, 2], // ABL -3
    },
    38: {
        "-": [0, 1], // ABL -2
    },
    39: {
        "-": [0], // ABL -1
    },
    40: {
        "-": [4], // ABT -9
    },
    41: {
        "-": [3, 4], // ABT -8
    },
    42: {
        "-": [2, 3, 4], // ABT -7
    },
    43: {
        "-": [1, 2, 3, 4], // ABT -6
    },
};

const formulaMap = {
    1: NO_FORMULA_SMALL,
    2: NO_FORMULA_SMALL,
    3: NO_FORMULA_SMALL,
    4: NO_FORMULA_SMALL,
    5: NO_FORMULA,
    6: NO_FORMULA,
    7: NO_FORMULA,
    8: NO_FORMULA,
    9: NO_FORMULA,
    10: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 5, 6],
            "-": [0, 1, 2, 3],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    11: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    12: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    13: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    14: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    15: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    16: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    17: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    18: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    19: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    20: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    21: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    22: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    23: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    24: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    25: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    26: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    27: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    28: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    29: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    30: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    31: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    32: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    33: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    34: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    35: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    36: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    37: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    38: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    39: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    40: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    41: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    42: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
    43: {
        0: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0],
        },
        1: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 5],
        },
        2: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 5, 6],
        },
        3: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 5, 6, 7],
        },
        4: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        5: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5],
        },
        6: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6],
        },
        7: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7],
        },
        8: {
            "+": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8],
        },
        9: {
            "+": [0, 1, 2, 3, 4, 6, 7, 8, 9],
            "-": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        },
    },
};

const mainNumber = {
    0: 0,
    1: 1,
    2: 2,
    3: 3,
    4: 4,
    5: 5,
    6: 6,
    7: 7,
    8: 8,
    9: 9,
    10: 4,
    11: 3,
    12: 2,
    13: 1,
    14: 4,
    15: 3,
    16: 2,
    17: 1,
    18: 9,
    19: 8,
    20: 7,
    21: 6,
    22: 5,
    23: 4,
    24: 3,
    25: 2,
    26: 1,
    27: 9,
    28: 8,
    29: 7,
    30: 6,
    31: 9,
    32: 8,
    33: 7,
    34: 6,
    35: 5,
    36: 4,
    37: 3,
    38: 2,
    39: 1,
    40: 9,
    41: 8,
    42: 7,
    43: 6,
};
const randomMathSmall = {
    0: {
        "+": [0, 1, 2, 3, 4],
        "-": [0, 1, 2, 3, 4],
    },
    1: {
        "+": [0, 1, 2, 3],
        "-": [1, 2, 3, 4],
    },
    2: {
        "+": [0, 1, 2],
        "-": [2, 3, 4],
    },
    3: {
        "+": [0, 1],
        "-": [3, 4],
    },
    4: {
        "+": [0],
        "-": [4],
    },
    5: {
        "+": [0, 1, 2, 3, 4],
        "-": [5, 6, 7, 8, 9],
    },
    6: {
        "+": [0, 1, 2, 3],
        "-": [6, 7, 8, 9],
    },
    7: {
        "+": [0, 1, 2],
        "-": [7, 8, 9],
    },
    8: {
        "+": [0, 1],
        "-": [8, 9],
    },
    9: {
        "+": [0],
        "-": [9],
    },
    10: {
        "+": [1, 2, 3, 4], // ABN +4
    },
    11: {
        "+": [2, 3, 4], // ABN +3
    },
    12: {
        "+": [3, 4], // ABN +2
    },
    13: {
        "+": [4], // ABN +1
    },
    14: {
        "-": [5, 6, 7, 8], // ABNT -4
    },
    15: {
        "-": [5, 6, 7], // ABNT -3
    },
    16: {
        "-": [5, 6], // ABNT -2
    },
    17: {
        "-": [5], // ABNT -1
    },
    18: {
        "+": [1, 2, 3, 4, 6, 7, 8, 9], // ABL +9
    },
    19: {
        "+": [2, 3, 4, 7, 8, 9], // ABL +8
    },
    20: {
        "+": [3, 4, 8, 9], // ABL +7
    },
    21: {
        "+": [4, 9], // ABL +6
    },
    22: {
        "+": [5, 6, 7, 8, 9], // ABL +5
    },
    23: {
        "+": [6, 7, 8, 9], // ABL +4
    },
    24: {
        "+": [7, 8, 9], // ABL +3
    },
    25: {
        "+": [8, 9], // ABL +2
    },
    26: {
        "+": [9], // ABL +1
    },
    27: {
        "+": [5], // ABT +9
    },
    28: {
        "+": [5, 6], // ABT +8
    },
    29: {
        "+": [5, 6, 7], // ABT +7
    },
    30: {
        "+": [5, 6, 7, 8], // ABT +6
    },
    31: {
        "-": [0, 1, 2, 3, 5, 6, 7, 8], // ABL -9
    },
    32: {
        "-": [0, 1, 2, 5, 6, 7], // ABL -8
    },
    33: {
        "-": [0, 1, 5, 6], // ABL -7
    },
    34: {
        "-": [0, 5], // ABL -6
    },
    35: {
        "-": [0, 1, 2, 3, 4], // ABL -5
    },
    36: {
        "-": [0, 1, 2, 3], // ABL -4
    },
    37: {
        "-": [0, 1, 2], // ABL -3
    },
    38: {
        "-": [0, 1], // ABL -2
    },
    39: {
        "-": [0], // ABL -1
    },
    40: {
        "-": [4], // ABT -9
    },
    41: {
        "-": [3, 4], // ABT -8
    },
    42: {
        "-": [2, 3, 4], // ABT -7
    },
    43: {
        "-": [1, 2, 3, 4], // ABT -6
    },
};

function getRandomSign() {
    return Math.random() < 0.5 ? "+" : "-";
}

function getRandomElement(arr) {
    if (!Array.isArray(arr) || arr.length === 0) {
        throw new Error("Input must be a non-empty array");
    }
    const randomIndex = Math.floor(Math.random() * arr.length);
    return arr[randomIndex];
}

function getMaxNDigitNumber(n) {
    if (n < 1) throw new Error("Số phải lớn hơn 0");
    return parseInt("9".repeat(n));
}

function getRandomNumberFromArray(n, arr) {
    if (!Array.isArray(arr) || arr.length === 0) {
        throw new Error("Mảng phải có ít nhất một phần tử");
    }
    if (n <= 0) {
        throw new Error("Số chữ số phải lớn hơn 0");
    }

    let result = "";
    for (let i = 0; i < n; i++) {
        const randomIndex = Math.floor(Math.random() * arr.length);
        result += arr[randomIndex];
    }
    return result;
}

function getRandomNDigitNumber(n, numbersArray, mustInclude, mainCourse) {
    if (n < 1) throw new Error("Số phải lớn hơn 1");
    if (mustInclude === undefined) {
        throw new Error("Số bắt buộc phải có không tồn tại trong mảng đầu vào");
    }

    console.log("n:", n);
    console.log("numbersArray:", numbersArray);
    console.log("mustInclude:", mustInclude);
    console.log("mainCourse:", mainCourse);

    let selectedNumbers = [];

    // Thêm số bắt buộc vào mảng nếu chưa có
    if (mustInclude !== undefined) {
        selectedNumbers.push(mustInclude);
    }

    // Chọn ngẫu nhiên các phần tử còn lại
    while (selectedNumbers.length < n) {
        const randomIndex = Math.floor(Math.random() * numbersArray.length);
        const randomNum = numbersArray[randomIndex];

        selectedNumbers.push(randomNum);
    }

    // Trộn ngẫu nhiên mảng để tránh số bắt buộc luôn đứng đầu
    selectedNumbers.sort(() => Math.random() - 0.5);

    // Nếu mainCourse > 31, đảm bảo mustInclude không đứng đầu
    if (mainCourse > 31 && selectedNumbers[0] === mustInclude) {
        const swapIndex = Math.floor(Math.random() * (n - 1)) + 1;
        [selectedNumbers[0], selectedNumbers[swapIndex]] = [
            selectedNumbers[swapIndex],
            selectedNumbers[0],
        ];
    }

    // Đảm bảo số 0 không đứng đầu nếu số có từ 2 chữ số trở lên
    if (n > 1 && selectedNumbers[0] === 0) {
        // Tìm một số khác 0 trong mảng để đổi chỗ
        for (let i = 1; i < selectedNumbers.length; i++) {
            if (selectedNumbers[i] !== 0) {
                [selectedNumbers[0], selectedNumbers[i]] = [
                    selectedNumbers[i],
                    selectedNumbers[0],
                ];
                break;
            }
        }
    }

    // Kết hợp thành số nguyên
    const combinedNumber = parseInt(selectedNumbers.join(""));

    console.log(`Số được tạo: ${combinedNumber}`);
    console.log(
        `Vị trí của ${mustInclude}: ${selectedNumbers.indexOf(mustInclude)}`
    );

    return combinedNumber;
}

const getRandomFirstDigitNumber = (
    numberOne,
    numberTwo,
    mainCourse,
    sign,
    allowExceed,
    maxNumber
) => {
    console.log("mainCourse", mainCourse);
    console.log("sign", sign);

    let randomMathObject = +mainCourse <= 4 ? randomMathSmall : randomMath;
    const validArray = randomMathObject[mainCourse][sign];
    const randomValidNumber = getRandomElement(validArray);
    console.log("validArray", validArray);
    console.log("randomValidNumber", randomValidNumber);

    let arrayRandom = [1, 2, 3, 4, 5, 6, 7, 8, 9];

    if (+mainCourse <= 4) {
        arrayRandom = [1, 2, 3, 4];
    }

    if (+mainCourse >= 31 && +mainCourse <= 34) {
        arrayRandom = [2, 3, 4, 6, 7, 8, 9];
    }

    if (+mainCourse >= 35) {
        arrayRandom = [2, 3, 4, 5, 6, 7, 8, 9];
    }

    let result;

    if (numberOne > numberTwo) {
        let randomFirstSplitNumber, randomSecondSplitNumber;
        do {
            randomFirstSplitNumber = getRandomNDigitNumber(
                +numberTwo,
                arrayRandom,
                +randomValidNumber,
                +mainCourse
            );
            randomSecondSplitNumber = getRandomNumberFromArray(
                parseInt(numberOne) - parseInt(numberTwo),
                arrayRandom
            );
            result = `${randomSecondSplitNumber}${randomFirstSplitNumber}`;
        } while (!allowExceed && parseInt(result) > maxNumber);

        return result;
    }

    do {
        result = getRandomNDigitNumber(
            +numberOne,
            arrayRandom,
            +randomValidNumber,
            +mainCourse
        );
    } while (!allowExceed && parseInt(result) > maxNumber);

    return result;
};

const randomNextNumber = (
    beforeValue,
    length,
    isMainCourse,
    sign,
    main,
    allowExceed,
    maxNumber,
    originMain
) => {
    console.log("beforeValue:", beforeValue);
    console.log("originMain:", originMain);
    let flag = beforeValue.length < length;
    if (flag) {
        sign = "+";
        beforeValue = beforeValue.padStart(length, "0");
    }

    if (+main <= 4 && !flag && beforeValue.includes("4")) {
        sign = "-";
    }

    const numberArray = beforeValue.split("");
    let randomNumber = "";
    let maxAttempts = 500;
    let attempts = 0;
    let allDigitsValid;
    let isMainExecute = false;
    do {
        randomNumber = ""; // Reset mỗi lần random
        for (let i = length - 1; i >= 0; i--) {
            let randomMathObject =
                +originMain === 4 ? randomMathSmall : randomMath;
            if (
                randomMathObject[main][sign] &&
                randomMathObject[main][sign].includes(+numberArray[i]) &&
                isMainCourse
            ) {
                isMainCourse = true;
                randomNumber = mainNumber[main].toString() + randomNumber;
                isMainExecute = true;
            } else {
                const maxLimit =
                    +originMain === 4 ? 4 : +originMain === 9 ? 9 : +main;
                const formula = formulaMap[+originMain];
                // +originMain === 4 ? NO_FORMULA_SMALL : NO_FORMULA;
                let newNumber;
                console.log("maxLimit", maxLimit);
                console.log("originMain", originMain);
                do {
                    newNumber = getRandomNumberFromArray(
                        1,
                        formula[numberArray[i]][sign]
                    );
                } while (
                    newNumber > maxLimit ||
                    (i === length - 1 && newNumber === 0)
                ); // Đảm bảo chữ số đầu không phải 0

                randomNumber = newNumber.toString() + randomNumber;
            }
        }

        let sum = Number(beforeValue) + Number(randomNumber);
        let sumDigits = String(sum).split("").map(Number);
        allDigitsValid = sumDigits.every((digit) => digit <= 4);

        console.log("Before:", beforeValue);
        console.log("Random:", randomNumber);
        console.log("Sum:", sum);
        console.log("Valid:", allDigitsValid);

        attempts++;
        if (attempts >= maxAttempts) {
            sign = "-";
            console.warn("Max attempts reached, returning fallback value.");
            return { randomNumber: beforeValue, sign, isMainExecute };
        }
        console.log(
            "Number(beforeValue) - Number(randomNumber)",
            Number(beforeValue) - Number(randomNumber)
        );
        console.log("Number(beforeValue)", Number(beforeValue));
        console.log("Number(randomNumber)", Number(randomNumber));
        console.log(
            "Number(beforeValue) - Number(randomNumber) < 0",
            Number(beforeValue) - Number(randomNumber) < 0
        );
    } while (
        randomNumber.length !== length ||
        randomNumber[0] === "0" ||
        (sign === "-" && Number(beforeValue) - Number(randomNumber) < 0) ||
        (!allowExceed &&
            sign === "+" &&
            Number(beforeValue) + Number(randomNumber) > +maxNumber)
    );

    return { randomNumber, sign, isMainExecute };
};

export const randomOperations = ({
    count,
    main,
    digits1,
    digits2,
    allowExceed
}, retries = 5) => {
    main = parseInt(main);
    let originMain = parseInt(main);
    if (main === 4) {
        main = getRandomElement([1, 2, 3, 4]);
    }

    if (main === 9) {
        main = getRandomElement([1, 2, 3, 4, 5, 6, 7, 8, 9]);
    }

    digits1 = parseInt(digits1);
    const maxNumber = getMaxNDigitNumber(digits1);

    // Nếu bài học chính > 31, số hạng 1 phải có ít nhất 2 chữ số
    if (main > 31 && digits1 < 2) {
        throw new BadRequestError("Số hạng 1 phải có ít nhất 2 chữ số. Vui lòng nhập lại.")
    }
    digits2 = parseInt(digits2);

    // // Kiểm tra số hạng 2 phải nhỏ hơn hoặc bằng số hạng 1
    if (digits2 > digits1) {
        throw new BadRequestError("Số hạng 2 không được lớn hơn số hạng 1. Vui lòng nhập lại.")

    }

    let sign = "";
    if (+main < 10) {
        sign =
            +digits2 > +digits1 ? "+" : getRandomSign();
    } else if (
        +main >= 10 &&
        +main <= 30 &&
        +main !== 14 &&
        +main !== 15 &&
        +main !== 16 &&
        +main !== 17
    ) {
        sign = "+";
    } else {
        if (+digits1 < +digits2) {
            throw new BadRequestError(
                "Vui lòng nhập số hạng 1 lớn hơn số hạng 2"
            );
        }
        if (+main > 31 && +digits1 === 1) {
            throw new BadRequestError(
                "Vui lòng nhập số hạng 1 nhiều hơn 1 phần từ"
            );
        }
        sign = "-";
    }
    try {
        const numberFirst = getRandomFirstDigitNumber(
            digits1,
            digits2,
            main,
            sign,
            allowExceed,
            maxNumber
        );
        let math = `${numberFirst}`;
        let max = Math.max(+digits1, +digits2);

        let countMain = 0;
        for (let i = 0; i < count - 1; i++) {
            let length =
                +digits1 === +digits2
                    ? max
                    : Math.floor(Math.random() * max) + 1;

            if (i === countMain) {
                if (+main < 10) {
                    sign =
                        +digits2 > +digits1
                            ? "+"
                            : getRandomSign();
                } else if (
                    +main >= 10 &&
                    +main <= 30 &&
                    +main !== 14 &&
                    +main !== 15 &&
                    +main !== 16 &&
                    +main !== 17
                ) {
                    sign = "+";
                } else {
                    sign = "-";
                }
                const valueNumber = eval(math);
                const nextNumber = randomNextNumber(
                    valueNumber.toString(),
                    length,
                    true,
                    sign,
                    main,
                    allowExceed,
                    maxNumber,
                    originMain
                );

                math = `${math} ${nextNumber.sign
                    } ${nextNumber.randomNumber.toString()}`;

                if (nextNumber.isMainExecute) {
                    countMain += 4;
                } else {
                    countMain += 2;
                }
            } else {

                const valueNumber = eval(math);
                if (valueNumber.toString().includes("9")) {
                    sign = "-";
                } else if (
                    valueNumber.toString().includes("0")
                ) {
                    sign = "+";
                } else {
                    sign = getRandomSign();
                }

                const nextNumber = randomNextNumber(
                    valueNumber.toString(),
                    length,
                    false,
                    sign,
                    main,
                    allowExceed,
                    maxNumber,
                    originMain
                );
                math = `${math} ${nextNumber.sign
                    } ${nextNumber.randomNumber.toString()}`;
            }
        }
        return  { expression: math, result: eval(math) } 
    } catch (err) {
        if (retries > 0) {
            return randomOperations({
                count,
                main,
                digits1,
                digits2,
                allowExceed

            }, retries - 1);
        }
    }

}

